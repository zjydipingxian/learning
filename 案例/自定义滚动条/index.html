<!DOCTYPE html>
<html>
<head>
	<meta charset="utf-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<title>自定义滚动条</title>
	<link rel="stylesheet" href="css/scroll.css">
</head>
<body>
	<div id="wrap" onselectstart="return false">
		<div id="text" onselectstart="return false">
	   			<p class="bold">1.Life was like a box of chocolates,you never know what you're going to get.</p>
		   		<p>生命就像巧克力，结果往往出人意料</p>
		   		<p class="bold">2.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">3.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">4.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">5.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">6.Death is just a part of life,someting we're all destined to do.</p>
		   		<p>死亡是生命的一部分，是我们注定要做的事</p>
		   		<p class="bold">7.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">8.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">9.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">10.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">11.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">12.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">13.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">14.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">15.Life was like a box of chocolates,you never know what you're going to get.</p>
		   		<p>生命就像巧克力，结果往往出人意料</p>
		   		<p class="bold">16.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">17.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">18.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">19.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">15.Life was like a box of chocolates,you never know what you're going to get.</p>
		   		<p>生命就像巧克力，结果往往出人意料</p>
		   		<p class="bold">16.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">17.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">18.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">19.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">20.Life was like a box of chocolates,you never know what you're going to get.</p>
		   		<p>生命就像巧克力，结果往往出人意料</p>
		   		<p class="bold">21.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">22.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">23.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">24.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
		   		<p class="bold">25.Life was like a box of chocolates,you never know what you're going to get.</p>
		   		<p>生命就像巧克力，结果往往出人意料</p>
		   		<p class="bold">26.Stupid is as stupid does.</p>
		   		<p>蠢人做蠢事，也可以理解为傻人有傻福</p>
		   		<p class="bold">27.Miracles happen everyday.</p>
		   		<p>奇迹每天都在发生</p>
		   		<p class="bold">28.It made me look like a duck in water.</p>
		   		<p>它让我如鱼得水</p>
		   		<p class="bold">29.I don't know if we each have a destiny,or if we're all just floating arround accidental like on a breeze.</p>
		   		<p>我不懂我们是否有着各自的命运，还是只是到处随风飘荡</p>
	   	</div>
	   	<div id="scroll">
	   		<div></div>
	   	</div>
	</div>
	<script type="text/javascript" src="js/scrollbar.js"></script>
	<script type="text/javascript">
		var oBox = document.getElementById('wrap'), //最外面的盒子
			oText = document.getElementById('text'),//文本区域
			oScroll = document.getElementById('scroll'),//右边大滚动条
			oball = document.querySelector('#scroll > div');//滚动条里面滑块

		var scrollHeight = parseFloat(getComputedStyle(oScroll).height);
			oball.style.height = oBox.clientHeight / oText.offsetHeight * scrollHeight + 'px';

		//滚动块scro_ball能运动的最大值
		var MaxBall = scrollHeight - parseFloat(getComputedStyle(oball).height),
			//文本能运动的最大值
			MaxCont = oText.offsetHeight - oBox.clientHeight;
			
		   	addEvent(oScroll,'mousedown',fn);


		//滚动块按下
		oball.onmousedown = function (e) {
			e = e || window.event;
			e.stopPropagation();
			var oDt = parseFloat(oball.style.top) || 0,//offsetTop取不到小数
	   			oTt = parseFloat(oText.style.top) || 0, 
	   			downY = e.clientY;//获取鼠标点击的位置
	   		console.log(oDt,oTt,downY)

	   		//ball运动
	   		document.onmousemove = function (e) {
	   			e = e || window.event;
	   			oScroll.style.display = 'block';
	   			var newY = e.clientY,
	   				nDt = oDt + newY - downY;

	   			//ball改变top值的时候对应text的top比例值
	   			setTop(nDt);	
	   		}
	   		document.onmouseup = function(){
				document.onmousemove = null;
				document.onmouseup = null;
	   		}
		};


		//文本滚动
		onWheel(oBox,scroll); //滚动条事件
		function scroll(e,d) {
			var top = oball.offsetTop;
			d < 0? top+=5 : top-=5;
			setTop(top);
		}


		addEvent(oScroll,'click',fn);  //点击滚动
		function fn(e) {
			e = e || window.event;
			var oDt = parseFloat(oball.style.top) || 0,
   				oTt = parseFloat(oText.style.top) || 0,
   				downY = e.clientY;
   			var nDt = downY - oBox.offsetTop - oball.offsetHeight/2;//div的top变化值	
   			console.log(nDt)
   			setTop(nDt);
		};

		//封装滚动条相同的功能
		function setTop(Stop) {
			//滚动块滚动
			Stop = Math.min(MaxBall,Stop);
       		Stop = Math.max(0,Stop);
       		oball.style.top = Stop + "px";
       		//文本内容区滚动
       		var conTop = MaxCont * Stop / MaxBall;
           		oText.style.top =  -conTop + "px";

		};

		oBox.onmouseenter = function(){
	   		oScroll.style.display = 'block';
	   	}
   		oBox.onmouseleave = function(){
   			oScroll.style.display = 'none';
   		}  	
	</script>
</body>
</html>